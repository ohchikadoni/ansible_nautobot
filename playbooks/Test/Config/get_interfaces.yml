---
- name: Get interfaces from Nautobot and save to file
  hosts: localhost
  gather_facts: no
  vars:
    nautobot_url: "http://10.10.10.101:8080/api/dcim/interfaces/?device=9ee2ad13-3be6-44e7-92ef-1103bbdfd8f6"
    nautobot_token: "Token 3a28f76fe9d03a5467e955e71cc5b37c6a047b18"
    output_file: "/tmp/interfaces.txt"
  tasks:
    - name: Retrieve interface data from Nautobot
      uri:
        url: "{{ nautobot_url }}"
        method: GET
        headers:
          Authorization: "Token 3a28f76fe9d03a5467e955e71cc5b37c6a047b18"
          Content-Type: "application/json; indent=4"
        return_content: yes
      register: response

    - name: Save interfaces data using Jinja2 template
      template:
        src: "interfaces.j2"
        dest: "{{ output_file }}"
      vars:
        interfaces: "{{ response.json.results }}"

    - name: Print output file path
      debug:
        msg: "Interfaces data saved to {{ output_file }}"
